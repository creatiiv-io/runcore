#!/bin/bash

# bash completion
function completion() {
  local action="$1"
  local subact=( "${@:2}" )

 [ "$action" = env ] && compgen -W "$(ls "$GITROOT/core/config/env.")" -- "$subact"
}

# display help
function help() {
  case $1 in
    env)
      echo "display environment"
      ;;
    *)
      echo "  $RUNNAME env"
      ;;
  esac
}

# run something
case $1 in
  $'\t') completion "${@:2}";; 
  help) help "${@:2}";;
  env)
    [ -n "$2" ] && serveconfig "$2"
    cleanroom env | sed -E '/^(#|$)/d; /^(SETTING|SHLVL|PWD|OLDPWD|_)=/d' | sort
    ;;
esac
